annotate("segment",x=miny,xend=maxy,y=0,yend=0,linetype="dashed",color="grey")+theme(legend.title=element_blank())
plot1
plot.X <- plot1 + facet_wrap( ~ SCENARIO,scales="free_y",ncol=mergecolnum) + ggtitle(paste("CO2",sep=" "))
plot.X
plot1 <- ggplot() +
geom_line(data=filter(Data4Plot,ModName!="Reference" &  Var %in% MultiVarList & Y<=maxy),aes(x=Y, y = Value , color=Var),stat="identity") +
geom_point(data=filter(Data4Plot,ModName!="Reference" &  Var %in% MultiVarList & Y<=maxy),aes(x=Y, y = Value , color=Var,shape=Var),size=1.5,fill="white") +
MyThemeLine + scale_color_manual(values=linepalettewName1) + scale_x_continuous(breaks=seq(miny,maxy,10)) +
scale_shape_manual(values = 1:length(unique(allmodelline$ModName))) +
xlab("year") + ylab("")  +  ggtitle("") +
annotate("segment",x=miny,xend=maxy,y=0,yend=0,linetype="dashed",color="grey")+theme(legend.title=element_blank())
plot.X <- plot1 + facet_wrap( ~ SCENARIO,scales="free_y",ncol=mergecolnum) + ggtitle(paste("CO2",sep=" "))
plot.X
Multilinemap <- read.table('../data/MultiVar.map',sep='\t',header=T)
Multilinemap <- read.table('../data/MultiVar.txt',sep='\t',header=T)
rr <- "World"
for(MultiLineItem in as.vector(uniq(Multilinemappara$Class))){}
for(MultiLineItem in as.vector(unique(Multilinemappara$Class))){}
for(MultiLineItem in as.vector(unique(Multilinemap$Class))){}
MultiLineItem
MultiVarList <- Multilinemap$Var[Multilinemap$Class==MultiLineItem]
MultiVarList
miny <- min(Data4Plot$Y,2010)
linepalettewName1 <- linepalette[1:length(Multilinemap$Var)]
names(linepalettewName1) <- MultiVarList$Var
linepalettewName1
MultiVarList
names(linepalettewName1) <- MultiVarList
Data4Plot <- allmodelline %>% filter(Region==rr & Var %in% MultiVarList & Var %in% as.vector(Multilinemap$Var & Y<=maxy)) %>% left_join(linemap,by="Var") %>% ungroup() %>%
filter(Class==MultiLineItem & ModName!="Reference") %>% select(ModName,SCENARIO,Ind,Y,Value,order)  %>% arrange(order)
Data4Plot <- allmodelline %>% filter(Region==rr & Var %in% MultiVarList & Y<=maxy)) %>% left_join(linemap,by="Var") %>% ungroup() %>%
Data4Plot <- allmodelline %>% filter(Region==rr & Var %in% MultiVarList & Y<=maxy) %>% left_join(linemap,by="Var") %>% ungroup() %>%
filter(Class==MultiLineItem & ModName!="Reference") %>% select(ModName,SCENARIO,Ind,Y,Value,order)  %>% arrange(order)
MultiVarList
MultiVarList <- Multilinemap[Multilinemap$Class==MultiLineItem]
MultiVarList
linepalettewName1 <- linepalette[1:length(Multilinemap$Var)]
names(linepalettewName1) <- MultiVarList
names(linepalettewName1) <- MultiVarList$Var
Data4Plot <- allmodelline %>% filter(Region==rr & Var %in% MultiVarList & Y<=maxy) %>% left_join(MultiVarList,by="Var") %>% ungroup() %>%
filter(Class==MultiLineItem & ModName!="Reference") %>% select(ModName,SCENARIO,Ind,Y,Value,order)  %>% arrange(order)
head(Data4Plot)
Data4Plot <- allmodelline %>% filter(Region==rr & Var %in% MultiVarList$Var & Y<=maxy) %>% left_join(MultiVarList,by="Var") %>% ungroup() %>%
filter(Class==MultiLineItem & ModName!="Reference") %>% select(ModName,SCENARIO,Ind,Y,Value,order)  %>% arrange(order)
Data4Plot
miny <- min(Data4Plot$Y,2010)
numitem1 <- length(as.vector(unique(Data4Plot$ModName))) #Get number of items
numitem2 <- length(as.vector(unique(Data4Plot$SCENARIO))) #Get number of items
numcol <- floor(sqrt(numitem1*numitem2))
plot1 <- ggplot() +
geom_line(data=Data4Plot,aes(x=Y, y = Value , color=Var),stat="identity") +
geom_point(data=Data4Plot,aes(x=Y, y = Value , color=Var,shape=Var),size=1.5,fill="white") +
MyThemeLine + scale_color_manual(values=linepalettewName1) + scale_x_continuous(breaks=seq(miny,maxy,10)) +
scale_shape_manual(values = 1:length(unique(allmodelline$ModName))) +
xlab("year") + ylab("")  + ggtitle(paste(rr,MultiLineItem,sep=" "))+facet_wrap(ModName ~ SCENARIO,scales="free_y",ncol=mergecolnum)
plot1 <- ggplot() +
geom_line(data=Data4Plot,aes(x=Y, y = Value , color=Var),stat="identity") +
geom_point(data=Data4Plot,aes(x=Y, y = Value , color=Var,shape=Var),size=1.5,fill="white") +
MyThemeLine + scale_color_manual(values=linepalettewName1) + scale_x_continuous(breaks=seq(miny,maxy,10)) +
scale_shape_manual(values = 1:length(unique(allmodelline$ModName))) +
xlab("year") + ylab("")  + ggtitle(paste(rr,MultiLineItem,sep=" "))+facet_wrap(ModName ~ SCENARIO,scales="free_y",ncol=mergecolnum) +
annotate("segment",x=miny,xend=maxy,y=0,yend=0,linetype="dashed",color="grey")+theme(legend.title=element_blank())
plot1
head(Data4Plot)
Data4Plot <- allmodelline %>% filter(Region==rr & Var %in% MultiVarList$Var & Y<=maxy) %>% left_join(MultiVarList,by="Var") %>% ungroup() %>%
filter(Class==MultiLineItem & ModName!="Reference") %>% select(ModName,SCENARIO,Ind,Var,Y,Value,order)  %>% arrange(order)
plot1 <- ggplot() +
geom_line(data=Data4Plot,aes(x=Y, y = Value , color=Var),stat="identity") +
geom_point(data=Data4Plot,aes(x=Y, y = Value , color=Var,shape=Var),size=1.5,fill="white") +
MyThemeLine + scale_color_manual(values=linepalettewName1) + scale_x_continuous(breaks=seq(miny,maxy,10)) +
scale_shape_manual(values = 1:length(unique(allmodelline$ModName))) +
xlab("year") + ylab("")  + ggtitle(paste(rr,MultiLineItem,sep=" "))+facet_wrap(ModName ~ SCENARIO,scales="free_y",ncol=mergecolnum) +
annotate("segment",x=miny,xend=maxy,y=0,yend=0,linetype="dashed",color="grey")+theme(legend.title=element_blank())
plot1
Multilinemap <- read.table('../data/MultiVar.txt',sep='\t',header=T)
rr <- "World"
for(MultiLineItem in as.vector(unique(Multilinemap$Class))){
MultiVarList <- Multilinemap[Multilinemap$Class==MultiLineItem]
linepalettewName1 <- linepalette[1:length(Multilinemap$Var)]
names(linepalettewName1) <- MultiVarList$Var
Data4Plot <- allmodelline %>% filter(Region==rr & Var %in% MultiVarList$Var & Y<=maxy) %>% left_join(MultiVarList,by="Var") %>% ungroup() %>%
filter(Class==MultiLineItem & ModName!="Reference") %>% select(ModName,SCENARIO,Ind,Var,Y,Value,order)  %>% arrange(order)
miny <- min(Data4Plot$Y,2010)
if(nrow(XX)>0){
numitem1 <- length(as.vector(unique(Data4Plot$ModName))) #Get number of items
numitem2 <- length(as.vector(unique(Data4Plot$SCENARIO))) #Get number of items
numcol <- floor(sqrt(numitem1*numitem2))
plot1 <- ggplot() +
geom_line(data=Data4Plot,aes(x=Y, y = Value , color=Var),stat="identity") +
geom_point(data=Data4Plot,aes(x=Y, y = Value , color=Var,shape=Var),size=1.5,fill="white") +
MyThemeLine + scale_color_manual(values=linepalettewName1) + scale_x_continuous(breaks=seq(miny,maxy,10)) +
scale_shape_manual(values = 1:length(unique(allmodelline$ModName))) +
xlab("year") + ylab("")  + ggtitle(paste(rr,MultiLineItem,sep=" "))+facet_wrap(ModName ~ SCENARIO,scales="free_y",ncol=mergecolnum) +
annotate("segment",x=miny,xend=maxy,y=0,yend=0,linetype="dashed",color="grey")+theme(legend.title=element_blank())
allplot[[MultiLineItem]] <- plot1
ggsave(plot3, file=paste0(outdir,"byRegion/",rr,"/png/merge/",MultiLineItem,"_",rr,".png"), dpi = 72, width=numcol*4, height=numcol*3,limitsize=FALSE)
ggsave(plot3, file=paste0(outdir,"byRegion/",rr,"/svg/merge/",MultiLineItem,"_",rr,".svg"), width=numcol*4, height=numcol*3,device = "svg",limitsize = FALSE, units = "in")
}
}
MultiVarList <- Multilinemap[Multilinemap$Class==MultiLineItem]
linepalettewName1 <- linepalette[1:length(Multilinemap$Var)]
names(linepalettewName1) <- MultiVarList$Var
Data4Plot <- allmodelline %>% filter(Region==rr & Var %in% MultiVarList$Var & Y<=maxy) %>% left_join(MultiVarList,by="Var") %>% ungroup() %>%
filter(Class==MultiLineItem & ModName!="Reference") %>% select(ModName,SCENARIO,Ind,Var,Y,Value,order)  %>% arrange(order)
MultiVarList$Var
MultiLineItem
MultiVarList <- Multilinemap[Multilinemap$Class==MultiLineItem]
MultiVarList
Multilinemap$Class
as.vector(unique(Multilinemap$Class))
MultiLineItem
Multilinemap$Class==MultiLineItem
MultiVarList <- Multilinemap[Multilinemap$Class==MultiLineItem]
MultiVarList
MultiVarList <- Multilinemap$[Multilinemap$Class==MultiLineItem]
MultiVarList <- Multilinemap[Multilinemap$Class==MultiLineItem]
MultiVarList
MultiVarList <- Multilinemap[Multilinemap$Class==MultiLineItem,]
MultiVarList
linepalettewName1 <- linepalette[1:length(Multilinemap$Var)]
names(linepalettewName1) <- MultiVarList$Var
Data4Plot <- allmodelline %>% filter(Region==rr & Var %in% MultiVarList$Var & Y<=maxy) %>% left_join(MultiVarList,by="Var") %>% ungroup() %>%
filter(Class==MultiLineItem & ModName!="Reference") %>% select(ModName,SCENARIO,Ind,Var,Y,Value,order)  %>% arrange(order)
Data4Plot <- allmodelline %>% filter(Region==rr & Var %in% MultiVarList$Var & Y<=maxy) %>% left_join(MultiVarList,by="Var") %>% ungroup() %>%
filter(Class==MultiLineItem & ModName!="Reference") %>% select(ModName,SCENARIO,Ind,Var,Y,Value,order)  %>% arrange(order)
miny <- min(Data4Plot$Y,2010)
numitem1 <- length(as.vector(unique(Data4Plot$ModName))) #Get number of items
numitem2 <- length(as.vector(unique(Data4Plot$SCENARIO))) #Get number of items
numcol <- floor(sqrt(numitem1*numitem2))
plot1 <- ggplot() +
geom_line(data=Data4Plot,aes(x=Y, y = Value , color=Var),stat="identity") +
geom_point(data=Data4Plot,aes(x=Y, y = Value , color=Var,shape=Var),size=1.5,fill="white") +
MyThemeLine + scale_color_manual(values=linepalettewName1) + scale_x_continuous(breaks=seq(miny,maxy,10)) +
scale_shape_manual(values = 1:length(unique(allmodelline$ModName))) +
xlab("year") + ylab("")  + ggtitle(paste(rr,MultiLineItem,sep=" "))+facet_wrap(ModName ~ SCENARIO,scales="free_y",ncol=mergecolnum) +
annotate("segment",x=miny,xend=maxy,y=0,yend=0,linetype="dashed",color="grey")+theme(legend.title=element_blank())
plot1
#Function for multi-variable line plot
funcMultiVarLinePlotGen <- function(rr,progr){
for(MultiLineItem in as.vector(unique(Multilinemap$Class))){
MultiVarList <- Multilinemap[Multilinemap$Class==MultiLineItem,]
linepalettewName1 <- linepalette[1:length(Multilinemap$Var)]
names(linepalettewName1) <- MultiVarList$Var
Data4Plot <- allmodelline %>% filter(Region==rr & Var %in% MultiVarList$Var & Y<=maxy) %>% left_join(MultiVarList,by="Var") %>% ungroup() %>%
filter(Class==MultiLineItem & ModName!="Reference") %>% select(ModName,SCENARIO,Ind,Var,Y,Value,order)  %>% arrange(order)
miny <- min(Data4Plot$Y,2010)
if(nrow(XX)>0){
numitem1 <- length(as.vector(unique(Data4Plot$ModName))) #Get number of items
numitem2 <- length(as.vector(unique(Data4Plot$SCENARIO))) #Get number of items
numcol <- floor(sqrt(numitem1*numitem2))
plot1 <- ggplot() +
geom_line(data=Data4Plot,aes(x=Y, y = Value , color=Var),stat="identity") +
geom_point(data=Data4Plot,aes(x=Y, y = Value , color=Var,shape=Var),size=1.5,fill="white") +
MyThemeLine + scale_color_manual(values=linepalettewName1) + scale_x_continuous(breaks=seq(miny,maxy,10)) +
scale_shape_manual(values = 1:length(unique(allmodelline$ModName))) +
xlab("year") + ylab("")  + ggtitle(paste(rr,MultiLineItem,sep=" "))+facet_wrap(ModName ~ SCENARIO,scales="free_y",ncol=mergecolnum) +
annotate("segment",x=miny,xend=maxy,y=0,yend=0,linetype="dashed",color="grey")+theme(legend.title=element_blank())
allplot[[MultiLineItem]] <- plot1
ggsave(plot3, file=paste0(outdir,"byRegion/",rr,"/png/merge/",MultiLineItem,"_",rr,".png"), dpi = 72, width=numcol*4, height=numcol*3,limitsize=FALSE)
ggsave(plot3, file=paste0(outdir,"byRegion/",rr,"/svg/merge/",MultiLineItem,"_",rr,".svg"), width=numcol*4, height=numcol*3,device = "svg",limitsize = FALSE, units = "in")
}
}
}
#execute making regional figures
exe_fig_make <- function(ListIte,Xfunc){
print(Sys.time())
if(parallelmode==1){
on.exit(plan(oplan), add = TRUE)
oplan <- plan(multisession,workers=threadsnum)
oplan
handlers('progress')
with_progress({
progr <- progressor(along=ListIte)
wrapped_func <- function(x) {
options(bitmapType = 'cairo')
Xfunc(x, progr = progr)
}
ListIte %>% future_map(wrapped_func)
})
}else{
progr <- progressor(along=ListIte)
lapply(ListIte, function(x) {
options(bitmapType = 'cairo')
Xfunc(x, progr = progr)
})
}
print(Sys.time())
}
#-----------------------
#Parameter configuration for iterations
nalist <- c(as.vector(varlist$V1),"TPES","POWER","Power_heat","Landuse","TFC_fuel","TFC_Sector","TFC_Ind","TFC_Tra","TFC_Res","TFC_Com","Investment")
allplot <- as.list(nalist)
allplot_nonleg <- as.list(nalist)
plotflag <- as.list(nalist)
names(allplot) <- nalist
names(allplot_nonleg) <- nalist
names(plotflag) <- nalist
allplotmerge <- as.list(nalist)
plotflagmerge <- as.list(nalist)
lst <- list()
if(args[8]=="global"){
if(RegSpec==0){
lst$region <- as.list(R17pR5pR2)
}else{
lst$region <- as.list(region_load)
}
}else{
lst$region <-as.list(args[8])
}
lst$varlist <- as.list(as.vector(varlist$V1))
lst$R10R <- as.list(R10R)
lst$R5R <- as.list(R5R)
lst$R2R <- as.list(R2R)
lst$Area <- as.list(as.vector(unique(areamappara$Class)))
#Creat directories
for(rr in lst$region){
dirlist <- c(paste0(outdir,"byRegion/",rr,"/png/line"),paste0(outdir,"byRegion/",rr,"/png/bar"),paste0(outdir,"byRegion/",rr,"/png/merge"),
paste0(outdir,"byRegion/",rr,"/svg/line"),paste0(outdir,"byRegion/",rr,"/svg/bar"),paste0(outdir,"byRegion/",rr,"/svg/merge"))
for(dd in dirlist){
if(file.exists(dd)){}else{dir.create(dd,recursive = TRUE)}
}
}
print("generating regional line figures with multiple varabels")
exe_fig_make(lst$region,funcMultiVarLinePlotGen)
#Function for multi-variable line plot
funcMultiVarLinePlotGen <- function(rr,progr){
for(MultiLineItem in as.vector(unique(Multilinemap$Class))){
MultiVarList <- Multilinemap[Multilinemap$Class==MultiLineItem,]
linepalettewName1 <- linepalette[1:length(Multilinemap$Var)]
names(linepalettewName1) <- MultiVarList$Var
Data4Plot <- allmodelline %>% filter(Region==rr & Var %in% MultiVarList$Var & Y<=maxy) %>% left_join(MultiVarList,by="Var") %>% ungroup() %>%
filter(Class==MultiLineItem & ModName!="Reference") %>% select(ModName,SCENARIO,Ind,Var,Y,Value,order)  %>% arrange(order)
miny <- min(Data4Plot$Y,2010)
if(nrow(Data4Plot)>0){
numitem1 <- length(as.vector(unique(Data4Plot$ModName))) #Get number of items
numitem2 <- length(as.vector(unique(Data4Plot$SCENARIO))) #Get number of items
numcol <- floor(sqrt(numitem1*numitem2))
plot1 <- ggplot() +
geom_line(data=Data4Plot,aes(x=Y, y = Value , color=Var),stat="identity") +
geom_point(data=Data4Plot,aes(x=Y, y = Value , color=Var,shape=Var),size=1.5,fill="white") +
MyThemeLine + scale_color_manual(values=linepalettewName1) + scale_x_continuous(breaks=seq(miny,maxy,10)) +
scale_shape_manual(values = 1:length(unique(allmodelline$ModName))) +
xlab("year") + ylab("")  + ggtitle(paste(rr,MultiLineItem,sep=" "))+facet_wrap(ModName ~ SCENARIO,scales="free_y",ncol=mergecolnum) +
annotate("segment",x=miny,xend=maxy,y=0,yend=0,linetype="dashed",color="grey")+theme(legend.title=element_blank())
allplot[[MultiLineItem]] <- plot1
ggsave(plot3, file=paste0(outdir,"byRegion/",rr,"/png/merge/",MultiLineItem,"_",rr,".png"), dpi = 72, width=numcol*4, height=numcol*3,limitsize=FALSE)
ggsave(plot3, file=paste0(outdir,"byRegion/",rr,"/svg/merge/",MultiLineItem,"_",rr,".svg"), width=numcol*4, height=numcol*3,device = "svg",limitsize = FALSE, units = "in")
}
}
}
exe_fig_make(lst$region,funcMultiVarLinePlotGen)
#Function for multi-variable line plot
funcMultiVarLinePlotGen <- function(rr,progr){
for(MultiLineItem in as.vector(unique(Multilinemap$Class))){
MultiVarList <- Multilinemap[Multilinemap$Class==MultiLineItem,]
linepalettewName1 <- linepalette[1:length(Multilinemap$Var)]
names(linepalettewName1) <- MultiVarList$Var
Data4Plot <- allmodelline %>% filter(Region==rr & Var %in% MultiVarList$Var & Y<=maxy) %>% left_join(MultiVarList,by="Var") %>% ungroup() %>%
filter(Class==MultiLineItem & ModName!="Reference") %>% select(ModName,SCENARIO,Ind,Var,Y,Value,order)  %>% arrange(order)
miny <- min(Data4Plot$Y,2010)
if(nrow(Data4Plot)>0){
numitem1 <- length(as.vector(unique(Data4Plot$ModName))) #Get number of items
numitem2 <- length(as.vector(unique(Data4Plot$SCENARIO))) #Get number of items
numcol <- floor(sqrt(numitem1*numitem2))
plot1 <- ggplot() +
geom_line(data=Data4Plot,aes(x=Y, y = Value , color=Var),stat="identity") +
geom_point(data=Data4Plot,aes(x=Y, y = Value , color=Var,shape=Var),size=1.5,fill="white") +
MyThemeLine + scale_color_manual(values=linepalettewName1) + scale_x_continuous(breaks=seq(miny,maxy,10)) +
scale_shape_manual(values = 1:length(unique(allmodelline$ModName))) +
xlab("year") + ylab("")  + ggtitle(paste(rr,MultiLineItem,sep=" "))+facet_wrap(ModName ~ SCENARIO,scales="free_y",ncol=mergecolnum) +
annotate("segment",x=miny,xend=maxy,y=0,yend=0,linetype="dashed",color="grey")+theme(legend.title=element_blank())
allplot[[MultiLineItem]] <- plot1
ggsave(plot1, file=paste0(outdir,"byRegion/",rr,"/png/merge/",MultiLineItem,"_",rr,".png"), dpi = 72, width=numcol*4, height=numcol*3,limitsize=FALSE)
ggsave(plot1, file=paste0(outdir,"byRegion/",rr,"/svg/merge/",MultiLineItem,"_",rr,".svg"), width=numcol*4, height=numcol*3,device = "svg",limitsize = FALSE, units = "in")
}
}
}
exe_fig_make(lst$region,funcMultiVarLinePlotGen)
#Function for multi-variable line plot
funcMultiVarLinePlotGen <- function(rr,progr){
for(MultiLineItem in as.vector(unique(Multilinemap$Class))){
MultiVarList <- Multilinemap[Multilinemap$Class==MultiLineItem,]
linepalettewName1 <- linepalette[1:length(Multilinemap$Var)]
names(linepalettewName1) <- MultiVarList$Ind
Data4Plot <- allmodel %>% filter(Region==rr & Var %in% MultiVarList$Var & Y<=maxy) %>% left_join(MultiVarList,by="Var") %>% ungroup() %>%
filter(Class==MultiLineItem & ModName!="Reference") %>% select(ModName,SCENARIO,Ind,Var,Y,Value,order)  %>% arrange(order)
miny <- min(Data4Plot$Y,2010)
if(nrow(Data4Plot)>0){
numitem1 <- length(as.vector(unique(Data4Plot$ModName))) #Get number of items
numitem2 <- length(as.vector(unique(Data4Plot$SCENARIO))) #Get number of items
numcol <- floor(sqrt(numitem1*numitem2))
plot1 <- ggplot() +
geom_line(data=Data4Plot,aes(x=Y, y = Value , color=Ind),stat="identity") +
geom_point(data=Data4Plot,aes(x=Y, y = Value , color=Ind,shape=Ind),size=1.5,fill="white") +
MyThemeLine + scale_color_manual(values=linepalettewName1) + scale_x_continuous(breaks=seq(miny,maxy,10)) +
scale_shape_manual(values = 1:length(unique(allmodelline$ModName))) +
xlab("year") + ylab("")  + ggtitle(paste(rr,MultiLineItem,sep=" "))+facet_wrap(ModName ~ SCENARIO,scales="free_y",ncol=mergecolnum) +
annotate("segment",x=miny,xend=maxy,y=0,yend=0,linetype="dashed",color="grey")+theme(legend.title=element_blank())
allplot[[MultiLineItem]] <- plot1
ggsave(plot1, file=paste0(outdir,"byRegion/",rr,"/png/merge/",MultiLineItem,"_",rr,".png"), dpi = 72, width=numcol*4, height=numcol*3,limitsize=FALSE)
ggsave(plot1, file=paste0(outdir,"byRegion/",rr,"/svg/merge/",MultiLineItem,"_",rr,".svg"), width=numcol*4, height=numcol*3,device = "svg",limitsize = FALSE, units = "in")
}
}
}
exe_fig_make(lst$region,funcMultiVarLinePlotGen)
allmodel_multiline <- filter(allmodel,Var %in% Multilinemap$Var)
#Function for multi-variable line plot
funcMultiVarLinePlotGen <- function(rr,progr){
for(MultiLineItem in as.vector(unique(Multilinemap$Class))){
MultiVarList <- Multilinemap[Multilinemap$Class==MultiLineItem,]
linepalettewName1 <- linepalette[1:length(Multilinemap$Var)]
names(linepalettewName1) <- MultiVarList$Ind
Data4Plot <- allmodel_multiline %>% filter(Region==rr & Var %in% MultiVarList$Var & Y<=maxy) %>% left_join(MultiVarList,by="Var") %>% ungroup() %>%
filter(Class==MultiLineItem & ModName!="Reference") %>% select(ModName,SCENARIO,Ind,Var,Y,Value,order)  %>% arrange(order)
miny <- min(Data4Plot$Y,2010)
if(nrow(Data4Plot)>0){
numitem1 <- length(as.vector(unique(Data4Plot$ModName))) #Get number of items
numitem2 <- length(as.vector(unique(Data4Plot$SCENARIO))) #Get number of items
numcol <- floor(sqrt(numitem1*numitem2))
plot1 <- ggplot() +
geom_line(data=Data4Plot,aes(x=Y, y = Value , color=Ind),stat="identity") +
geom_point(data=Data4Plot,aes(x=Y, y = Value , color=Ind,shape=Ind),size=1.5,fill="white") +
MyThemeLine + scale_color_manual(values=linepalettewName1) + scale_x_continuous(breaks=seq(miny,maxy,10)) +
scale_shape_manual(values = 1:length(unique(allmodelline$ModName))) +
xlab("year") + ylab("")  + ggtitle(paste(rr,MultiLineItem,sep=" "))+facet_wrap(ModName ~ SCENARIO,scales="free_y",ncol=mergecolnum) +
annotate("segment",x=miny,xend=maxy,y=0,yend=0,linetype="dashed",color="grey")+theme(legend.title=element_blank())
allplot[[MultiLineItem]] <- plot1
ggsave(plot1, file=paste0(outdir,"byRegion/",rr,"/png/merge/",MultiLineItem,"_",rr,".png"), dpi = 72, width=numcol*4, height=numcol*3,limitsize=FALSE)
ggsave(plot1, file=paste0(outdir,"byRegion/",rr,"/svg/merge/",MultiLineItem,"_",rr,".svg"), width=numcol*4, height=numcol*3,device = "svg",limitsize = FALSE, units = "in")
}
}
}
exe_fig_make(lst$region,funcMultiVarLinePlotGen)
Multilinemap <- read.table('../data/MultiVar.txt',sep='\t',header=T)
#Function for multi-variable line plot
funcMultiVarLinePlotGen <- function(rr,progr){
for(MultiLineItem in as.vector(unique(Multilinemap$Class))){
MultiVarList <- Multilinemap[Multilinemap$Class==MultiLineItem,]
linepalettewName1 <- linepalette[1:length(Multilinemap$Var)]
names(linepalettewName1) <- MultiVarList$Ind
Data4Plot <- allmodel_multiline %>% filter(Region==rr & Var %in% MultiVarList$Var & Y<=maxy) %>% left_join(MultiVarList,by="Var") %>% ungroup() %>%
filter(Class==MultiLineItem & ModName!="Reference") %>% select(ModName,SCENARIO,Ind,Var,Y,Value,order)  %>% arrange(order)
miny <- min(Data4Plot$Y,2010)
if(nrow(Data4Plot)>0){
numitem1 <- length(as.vector(unique(Data4Plot$ModName))) #Get number of items
numitem2 <- length(as.vector(unique(Data4Plot$SCENARIO))) #Get number of items
numcol <- floor(sqrt(numitem1*numitem2))
plot1 <- ggplot() +
geom_line(data=Data4Plot,aes(x=Y, y = Value , color=Ind),stat="identity") +
geom_point(data=Data4Plot,aes(x=Y, y = Value , color=Ind,shape=Ind),size=1.5,fill="white") +
MyThemeLine + scale_color_manual(values=linepalettewName1) + scale_x_continuous(breaks=seq(miny,maxy,10)) +
scale_shape_manual(values = 1:length(unique(allmodelline$ModName))) +
xlab("year") + ylab("")  + ggtitle(paste(rr,MultiLineItem,sep=" "))+facet_wrap(ModName ~ SCENARIO,scales="free_y",ncol=mergecolnum) +
annotate("segment",x=miny,xend=maxy,y=0,yend=0,linetype="dashed",color="grey")+theme(legend.title=element_blank())
allplot[[MultiLineItem]] <- plot1
ggsave(plot1, file=paste0(outdir,"byRegion/",rr,"/png/merge/",MultiLineItem,"_",rr,".png"), dpi = 72, width=numcol*4, height=numcol*3,limitsize=FALSE)
ggsave(plot1, file=paste0(outdir,"byRegion/",rr,"/svg/merge/",MultiLineItem,"_",rr,".svg"), width=numcol*4, height=numcol*3,device = "svg",limitsize = FALSE, units = "in")
}
}
}
exe_fig_make(lst$region,funcMultiVarLinePlotGen)
Multilinemap <- read.table('../data/MultiVar.txt',sep='\t',header=T)
Multilinemap
Multilinemap <- read.table('../data/MultiVar.txt',sep='\t',header=T)
#Function for multi-variable line plot
funcMultiVarLinePlotGen <- function(rr,progr){
for(MultiLineItem in as.vector(unique(Multilinemap$Class))){
MultiVarList <- Multilinemap[Multilinemap$Class==MultiLineItem,]
linepalettewName1 <- linepalette[1:length(Multilinemap$Var)]
names(linepalettewName1) <- MultiVarList$Ind
Data4Plot <- allmodel_multiline %>% filter(Region==rr & Var %in% MultiVarList$Var & Y<=maxy) %>% left_join(MultiVarList,by="Var") %>% ungroup() %>%
filter(Class==MultiLineItem & ModName!="Reference") %>% select(ModName,SCENARIO,Ind,Var,Y,Value,order)  %>% arrange(order)
miny <- min(Data4Plot$Y,2010)
if(nrow(Data4Plot)>0){
numitem1 <- length(as.vector(unique(Data4Plot$ModName))) #Get number of items
numitem2 <- length(as.vector(unique(Data4Plot$SCENARIO))) #Get number of items
numcol <- floor(sqrt(numitem1*numitem2))
plot1 <- ggplot() +
geom_line(data=Data4Plot,aes(x=Y, y = Value , color=Ind),stat="identity") +
geom_point(data=Data4Plot,aes(x=Y, y = Value , color=Ind,shape=Ind),size=1.5,fill="white") +
MyThemeLine + scale_color_manual(values=linepalettewName1) + scale_x_continuous(breaks=seq(miny,maxy,10)) +
scale_shape_manual(values = 1:length(unique(allmodelline$ModName))) +
xlab("year") + ylab("")  + ggtitle(paste(rr,MultiLineItem,sep=" "))+facet_wrap(ModName ~ SCENARIO,scales="free_y",ncol=mergecolnum) +
annotate("segment",x=miny,xend=maxy,y=0,yend=0,linetype="dashed",color="grey")+theme(legend.title=element_blank())
allplot[[MultiLineItem]] <- plot1
ggsave(plot1, file=paste0(outdir,"byRegion/",rr,"/png/merge/",MultiLineItem,"_",rr,".png"), dpi = 72, width=numcol*4, height=numcol*3,limitsize=FALSE)
ggsave(plot1, file=paste0(outdir,"byRegion/",rr,"/svg/merge/",MultiLineItem,"_",rr,".svg"), width=numcol*4, height=numcol*3,device = "svg",limitsize = FALSE, units = "in")
}
}
}
exe_fig_make(lst$region,funcMultiVarLinePlotGen)
Multilinemap <- read.table('../data/MultiVar.txt',sep='\t',header=T)
Multilinemap <- read.table('../data/MultiVar.txt',sep='\t',header=T)
#Function for multi-variable line plot
funcMultiVarLinePlotGen <- function(rr,progr){
for(MultiLineItem in as.vector(unique(Multilinemap$Class))){
MultiVarList <- Multilinemap[Multilinemap$Class==MultiLineItem,]
linepalettewName1 <- linepalette[1:length(Multilinemap$Var)]
names(linepalettewName1) <- MultiVarList$Ind
Data4Plot <- allmodel_multiline %>% filter(Region==rr & Var %in% MultiVarList$Var & Y<=maxy) %>% left_join(MultiVarList,by="Var") %>% ungroup() %>%
filter(Class==MultiLineItem & ModName!="Reference") %>% select(ModName,SCENARIO,Ind,Var,Y,Value,order)  %>% arrange(order)
miny <- min(Data4Plot$Y,2010)
if(nrow(Data4Plot)>0){
numitem1 <- length(as.vector(unique(Data4Plot$ModName))) #Get number of items
numitem2 <- length(as.vector(unique(Data4Plot$SCENARIO))) #Get number of items
numcol <- floor(sqrt(numitem1*numitem2))
plot1 <- ggplot() +
geom_line(data=Data4Plot,aes(x=Y, y = Value , color=Ind),stat="identity") +
geom_point(data=Data4Plot,aes(x=Y, y = Value , color=Ind,shape=Ind),size=1.5,fill="white") +
MyThemeLine + scale_color_manual(values=linepalettewName1) + scale_x_continuous(breaks=seq(miny,maxy,10)) +
scale_shape_manual(values = 1:length(unique(allmodelline$ModName))) +
xlab("year") + ylab("")  + ggtitle(paste(rr,MultiLineItem,sep=" "))+facet_wrap(ModName ~ SCENARIO,scales="free_y",ncol=mergecolnum) +
annotate("segment",x=miny,xend=maxy,y=0,yend=0,linetype="dashed",color="grey")+theme(legend.title=element_blank())
allplot[[MultiLineItem]] <- plot1
ggsave(plot1, file=paste0(outdir,"byRegion/",rr,"/png/merge/",MultiLineItem,"_",rr,".png"), dpi = 72, width=numcol*4, height=numcol*3,limitsize=FALSE)
ggsave(plot1, file=paste0(outdir,"byRegion/",rr,"/svg/merge/",MultiLineItem,"_",rr,".svg"), width=numcol*4, height=numcol*3,device = "svg",limitsize = FALSE, units = "in")
}
}
}
exe_fig_make(lst$region,funcMultiVarLinePlotGen)
Multilinemap
as.vector(unique(Multilinemap$Class))
MultiVarList <- Multilinemap[Multilinemap$Class==MultiLineItem,]
MultiVarList
linepalettewName1 <- linepalette[1:length(Multilinemap$Var)]
MultiVarList
#Function for multi-variable line plot
funcMultiVarLinePlotGen <- function(rr,progr){
for(MultiLineItem in as.vector(unique(Multilinemap$Class))){
MultiVarList <- Multilinemap[Multilinemap$Class==MultiLineItem,]
linepalettewName1 <- linepalette[1:length(Multilinemap$Var)]
names(linepalettewName1) <- MultiVarList$Ind
Data4Plot <- allmodel_multiline %>% filter(Region==rr & Var %in% MultiVarList$Var & Y<=maxy) %>% left_join(MultiVarList,by="Var") %>% ungroup() %>%
filter(Class==MultiLineItem & ModName!="Reference") %>% select(ModName,SCENARIO,Ind,Var,Y,Value,order)  %>% arrange(order)
miny <- min(Data4Plot$Y,2010)
if(nrow(Data4Plot)>0){
numitem1 <- length(as.vector(unique(Data4Plot$ModName))) #Get number of items
numitem2 <- length(as.vector(unique(Data4Plot$SCENARIO))) #Get number of items
numcol <- floor(sqrt(numitem1*numitem2))
plot1 <- ggplot() +
geom_line(data=Data4Plot,aes(x=Y, y = Value , color=Ind),stat="identity") +
geom_point(data=Data4Plot,aes(x=Y, y = Value , color=Ind,shape=Ind),size=1.5,fill="white") +
MyThemeLine + scale_color_manual(values=linepalettewName1) + scale_x_continuous(breaks=seq(miny,maxy,10)) +
scale_shape_manual(values = 1:length(unique(allmodelline$ModName))) +
xlab("year") + ylab("")  + ggtitle(paste(rr,MultiLineItem,sep=" "))+facet_wrap(ModName ~ SCENARIO,scales="free_y",ncol=mergecolnum) +
annotate("segment",x=miny,xend=maxy,y=0,yend=0,linetype="dashed",color="grey")+theme(legend.title=element_blank())
allplot[[MultiLineItem]] <- plot1
ggsave(plot1, file=paste0(outdir,"byRegion/",rr,"/png/merge/",MultiLineItem,"_",rr,".png"), dpi = 72, width=numcol*4, height=numcol*3,limitsize=FALSE)
ggsave(plot1, file=paste0(outdir,"byRegion/",rr,"/svg/merge/",MultiLineItem,"_",rr,".svg"), width=numcol*4, height=numcol*3,device = "svg",limitsize = FALSE, units = "in")
}
}
}
exe_fig_make(lst$region,funcMultiVarLinePlotGen)
allmodel_multiline <- filter(allmodel,Var %in% Multilinemap$Var)
exe_fig_make(lst$region,funcMultiVarLinePlotGen)
linepalettewName1 <- linepalette[1:length(Multilinemap$Var)]
Hub2TechMQ
MultiVarList <- Multilinemap[Multilinemap$Class==MultiLineItem,]
MultiVarList
linepalettewName1 <- linepalette[1:length(Multilinemap$Var)]
linepalettewName1
linepalettewName1 <- linepalette[1:length(MultiVarList$Var)]
names(linepalettewName1) <- MultiVarList$Ind
Data4Plot <- allmodel_multiline %>% filter(Region==rr & Var %in% MultiVarList$Var & Y<=maxy) %>% left_join(MultiVarList,by="Var") %>% ungroup() %>%
filter(Class==MultiLineItem & ModName!="Reference") %>% select(ModName,SCENARIO,Ind,Var,Y,Value,order)  %>% arrange(order)
miny <- min(Data4Plot$Y,2010)
numitem1 <- length(as.vector(unique(Data4Plot$ModName))) #Get number of items
numitem2 <- length(as.vector(unique(Data4Plot$SCENARIO))) #Get number of items
numcol <- floor(sqrt(numitem1*numitem2))
plot1 <- ggplot() +
geom_line(data=Data4Plot,aes(x=Y, y = Value , color=Ind),stat="identity") +
geom_point(data=Data4Plot,aes(x=Y, y = Value , color=Ind,shape=Ind),size=1.5,fill="white") +
MyThemeLine + scale_color_manual(values=linepalettewName1) + scale_x_continuous(breaks=seq(miny,maxy,10)) +
scale_shape_manual(values = 1:length(unique(allmodelline$ModName))) +
xlab("year") + ylab("")  + ggtitle(paste(rr,MultiLineItem,sep=" "))+facet_wrap(ModName ~ SCENARIO,scales="free_y",ncol=mergecolnum) +
annotate("segment",x=miny,xend=maxy,y=0,yend=0,linetype="dashed",color="grey")+theme(legend.title=element_blank())
allplot[[MultiLineItem]] <- plot1
ggsave(plot1, file=paste0(outdir,"byRegion/",rr,"/png/merge/",MultiLineItem,"_",rr,".png"), dpi = 72, width=numcol*4, height=numcol*3,limitsize=FALSE)
length(unique(allmodelline$ModName))
plot1 <- ggplot() +
geom_line(data=Data4Plot,aes(x=Y, y = Value , color=Ind),stat="identity") +
geom_point(data=Data4Plot,aes(x=Y, y = Value , color=Ind,shape=Ind),size=1.5,fill="white") +
MyThemeLine + scale_color_manual(values=linepalettewName1) + scale_x_continuous(breaks=seq(miny,maxy,10)) +
xlab("year") + ylab("")  + ggtitle(paste(rr,MultiLineItem,sep=" "))+facet_wrap(ModName ~ SCENARIO,scales="free_y",ncol=mergecolnum) +
annotate("segment",x=miny,xend=maxy,y=0,yend=0,linetype="dashed",color="grey")+theme(legend.title=element_blank())
plot1
#Function for multi-variable line plot
funcMultiVarLinePlotGen <- function(rr,progr){
for(MultiLineItem in as.vector(unique(Multilinemap$Class))){
MultiVarList <- Multilinemap[Multilinemap$Class==MultiLineItem,]
linepalettewName1 <- linepalette[1:length(MultiVarList$Var)]
names(linepalettewName1) <- MultiVarList$Ind
Data4Plot <- allmodel_multiline %>% filter(Region==rr & Var %in% MultiVarList$Var & Y<=maxy) %>% left_join(MultiVarList,by="Var") %>% ungroup() %>%
filter(Class==MultiLineItem & ModName!="Reference") %>% select(ModName,SCENARIO,Ind,Var,Y,Value,order)  %>% arrange(order)
miny <- min(Data4Plot$Y,2010)
if(nrow(Data4Plot)>0){
numitem1 <- length(as.vector(unique(Data4Plot$ModName))) #Get number of items
numitem2 <- length(as.vector(unique(Data4Plot$SCENARIO))) #Get number of items
numcol <- floor(sqrt(numitem1*numitem2))
plot1 <- ggplot() +
geom_line(data=Data4Plot,aes(x=Y, y = Value , color=Ind),stat="identity") +
geom_point(data=Data4Plot,aes(x=Y, y = Value , color=Ind,shape=Ind),size=1.5,fill="white") +
MyThemeLine + scale_color_manual(values=linepalettewName1) + scale_x_continuous(breaks=seq(miny,maxy,10)) +
xlab("year") + ylab("")  + ggtitle(paste(rr,MultiLineItem,sep=" "))+facet_wrap(ModName ~ SCENARIO,scales="free_y",ncol=mergecolnum) +
annotate("segment",x=miny,xend=maxy,y=0,yend=0,linetype="dashed",color="grey")+theme(legend.title=element_blank())
allplot[[MultiLineItem]] <- plot1
ggsave(plot1, file=paste0(outdir,"byRegion/",rr,"/png/merge/",MultiLineItem,"_",rr,".png"), dpi = 72, width=numcol*4, height=numcol*3,limitsize=FALSE)
ggsave(plot1, file=paste0(outdir,"byRegion/",rr,"/svg/merge/",MultiLineItem,"_",rr,".svg"), width=numcol*4, height=numcol*3,device = "svg",limitsize = FALSE, units = "in")
}
}
}
exe_fig_make(lst$region,funcMultiVarLinePlotGen)
